#include <avr/pgmspace.h>
#define noteName pgm_read_word_near(&note[i][0])
#define duration pgm_read_word_near(&note[i][1])

#define c3 1
#define C3 2
#define d3 3
#define D3 4
#define e3 5
#define f3 6
#define F3 7
#define g3 8
#define G3 9
#define a3 10
#define A3 11
#define b3 12
#define c 13
#define C 14
#define d 15
#define D 16
#define e 17
#define f 18
#define F 19
#define g 20
#define G 21
#define a 22
#define A 23
#define b 24
#define c5 25
#define C5 26
#define d5 27
#define D5 28
#define e5 29
#define f5 30
#define F5 31
#define g5 32
#define G5 33
#define a5 34
#define A5 35
#define b5 36

const int pitch[]={
  131,139,147,156,165,175,
  185,196,208,220,233,247,
  262,277,294,311,330,349,
  370,392,415,440,466,494,
  523,554,587,622,659,699,
  740,784,831,880,932,988
};

//https://pianoletternotes.blogspot.com/2017/10/megalovania-undertale-theme.html

const PROGMEM short note[][2]={  // 0 is pause
  //starting
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {b3,4},{b3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {A3,4},{A3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {b3,4},{b3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {A3,4},{A3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {b3,4},{b3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {A3,4},{A3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {b3,4},{b3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {A3,4},{A3,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  
  //main
  {f,2},{f,4},{f,2},{f,2},{f,2},{d,2},{d,2},{0,4},
  {d,2},{f,4},{f,4},{f,4},{f,2},{g,2},{G,2},{g,4},{f,4},{d,4},{f,4},{g,4},{0,2},
  {f,2},{f,4},{f,2},{g,2},{G,2},{a,2},{c5,2},{a,2},{0,4},{d5,2},{d5,2},{d5,4},{a,4},{d5,4},{c5,1},{0,4},{0,1},
  {a,2},{a,4},{a,2},{a,2},{a,2},{g,2},{g,1},{0,4},
  {a,2},{a,4},{a,2},{a,2},{g,2},{a,2},{d5,2},{a,4},{g,2},
  {d5,2},{a,2},{g,2},{f,2},{c5,2},{a,2},{g,2},{f,2},{d,2},{e,4},{f,2},{a,2},{c5,1},{0,1},{0,1},{0,1},{0,4},
  
  {f,4},{d,4},{f,4},{g,4},{G,4},{g,4},{f,4},{d,4},{G,4},{g,4},{f,4},{d,4},{f,4},{g,1},{0,1},{0,4},
  {G,2},{a,4},{c5,2},{a,4},{G,4},{g,4},{f,4},{d,4},{e,4},{f,2},{g,2},{G,2},{c5,2},{C5,2},{G,2},{G,4},{g,4},{f,4},{g,1},{0,1},{0,4},
  {f3,2},{g3,2},{a3,2},{f,2},{e,1},{d,1},{e,1},{f,1},{g,1},{e,1},{a,1},{0,1},
  {a,4},{G,4},{g,4},{F,4},{f,4},{e,4},{D,4},{d,4},{C,1},{0,1},{D,1},{0,1},{0,1},{0,1},
  
  {f,4},{d,4},{f,4},{g,4},{G,4},{g,4},{f,4},{d,4},{G,4},{g,4},{f,4},{d,4},{e,4},{g,1},{0,1},{0,4},
  {G,2},{a,4},{c5,2},{a,4},{G,4},{g,4},{f,4},{d,4},{e,4},{f,2},{g,2},{a,2},{c5,2},{C5,2},{G,2},{G,4},{g,4},{f,4},{g,1},{0,1},{0,2},{0,4},
  {f3,2},{g3,2},{a3,2},{f,2},{e,1},{d,1},{e,1},{f,1},{g,1},{e,1},{a,1},{0,1},
  {a,4},{G,4},{g,4},{F,4},{f,4},{e,4},{D,4},{d,4},{C,1},{0,1},{D,1},{0,1},{0,2},
  
  {b3,1},{0,1},{0,1},{f,1},{e,1},{0,1},{d,1},{0,1},{f,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},
  {b3,1},{0,1},{0,1},{f,1},{e,1},{0,1},{d,1},{0,1},{d,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},
  {b3,1},{0,1},{0,1},{f,1},{e,1},{0,1},{d,1},{0,1},{f,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},
  {b3,1},{0,1},{0,1},{f,1},{e,1},{0,1},{d,1},{0,1},{d,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},{0,1},
  
  //ending
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {C,4},{C,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {d,4},{d,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {C,4},{C,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
  {c,4},{c,4},{d5,4},{0,4},{a,4},{0,2},{G,4},{0,4},{g,4},{0,4},{f,4},{0,4},{d,4},{f,4},{g,4},
};

const int notes=sizeof note / sizeof note[0];

const int BPM=120;

void setup() {
  pinMode(3,OUTPUT);
  Serial.begin(9600);
  while(!Serial);
  
  for(int i=0;i<notes;i++){
    Serial.print(noteName);
    Serial.print(", ");
    Serial.println(duration);
    if(noteName!=0)
      tone(3,pitch[noteName-1]);
    delay((60000/BPM)/duration);
    noTone(3);
    delay(20);
  }
}

void loop() {
}
